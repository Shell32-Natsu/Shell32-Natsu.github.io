<!DOCTYPE html>
<html lang="en">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />









  <link rel="alternate" href="/atom.xml" title="Shell32">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.3.x" />



<link rel="canonical" href="http://blog.xiadong.info/page/41/"/>


<meta property="og:type" content="website">
<meta property="og:title" content="Shell32">
<meta property="og:url" content="http://blog.xiadong.info/page/41/index.html">
<meta property="og:site_name" content="Shell32">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Shell32">
<meta name="twitter:card" content="summary">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.3.x" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />





<script>
  var CONFIG = {
    search: false,
    searchPath: "/search.xml",
    fancybox: true,
    toc: true,
  }
</script>




  

  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-97442160-1', 'auto');
        ga('send', 'pageview');
  </script>




<script>
  (function(d) {
    var config = {
      kitId: 'tqr0ojg',
      scriptTimeout: 3000,
      async: true
    },
    h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
  })(document);
</script>

    <title> Shell32 </title>
  <meta name="generator" content="Hexo 4.2.1"></head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Shell32</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            Home
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            Tags
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            Categories
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            About
          
        </li>
      </a>
    
      <a href="https://cse.google.com/cse/publicurl?cx=007205548471419455342:wndla_xl_3e" target="_blank" rel="noopener">
        <li class="mobile-menu-item">
          
          
            Search
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Shell32</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              Home
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              Archives
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              Tags
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              Categories
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              About
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="https://cse.google.com/cse/publicurl?cx=007205548471419455342:wndla_xl_3e" target="_blank" rel="noopener">
            
            
              Search
            
          </a>
        </li>
      
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  <section id="posts" class="posts">
    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2016/07/08/leetcode-372-super-pow/">LeetCode 372. Super Pow</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Jul 8, 2016
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>题目描述:</p>
<blockquote>
<p>Your task is to calculate ab mod 1337 where a is a positive integer and b is an extremely large positive integer given in the form of an array.</p>
</blockquote>
<blockquote>
<p>Example1:</p>
</blockquote>
<blockquote>
<pre><code>a = 2
b = [3]
</code></pre>
</blockquote>
<blockquote>
<pre><code>Result: 8
</code></pre>
<p>Example2:</p>
</blockquote>
<blockquote>
<pre><code>a = 2
b = [1,0]
</code></pre>
</blockquote>
<blockquote>
<pre><code>Result: 1024
</code></pre>
</blockquote>
<p>计算a的b次幂的值, 其中b很大并且用数组表示. 关键在于结果要对于1337取余, 这就意味着在计算过程中不会发生溢出问题. 根据公式:</p>
<pre><code>(a * b) % n = ((a % n) * (b % n)) % n
</code></pre>
<p>以及</p>
<pre><code>a ^ (n + m) = (a ^ n) * (a ^ m)
</code></pre>
<p>用b{i}表示数组b中到下标i为止的数, <code>a ^ b{i} = ((a ^ b{i - 1}) ^ 10) * (a ^ b[i])</code>, 把幂运算替换为乘法运算和循环, 在每一个循环体中都对结果取余. 就可以得到结果. 其中b[i]为0和第一次循环要特别处理.</p>
<p>代码如下, 耗时24ms:</p>
<pre><code>class Solution {
    int MOD = 1337;
public:
    int superPow(int a, vector&lt;int&gt;&amp; b) {
        int ret = 0;
        for(int i = 0; i &lt; b.size(); i++){
            int t = b[i], retPowTen = 1;
            long long powT = 1;
            for(int j = 0; j &lt; 10; j++){
                retPowTen = (retPowTen * ret) % MOD;
            }
            ret = retPowTen;
            if(t == 0){
                powT = 0;
            }
            else{
                for(int j = 0; j &lt; t; j++){
                    powT = (powT * a) % MOD;
                }
            }
            if(powT &amp;&amp; ret)
                ret = (ret * (powT % MOD)) % MOD;
            else if(!ret)
                ret = powT % MOD;
            else
                ret = ret % MOD;
        }
        return ret;
    }
};
</code></pre>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2016/07/08/leetcode-2-add-tow-numbers/">LeetCode 2. Add Tow Numbers</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Jul 8, 2016
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>题目:</p>
<blockquote>
<p>You are given two linked lists representing two non-negative numbers. The digits are stored in reverse order and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.</p>
</blockquote>
<blockquote>
<p>Input: (2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)</p>
</blockquote>
<blockquote>
<p>Output: 7 -&gt; 0 -&gt; 8</p>
</blockquote>
<p>简单的加法模拟, 代码如下:</p>
<pre><code>/**
* Definition for singly-linked list.
* struct ListNode {
*     int val;
*     ListNode *next;
*     ListNode(int x) : val(x), next(NULL) {}
* };
*/
class Solution {
public:
    ListNode* addTwoNumbers(ListNode* l1, ListNode* l2) {
        //如果有一个链表为空,则直接返回另一个
        if(l1 == nullptr)
            return l2;
        if(l2 == nullptr)
            return l1;
            
        ListNode *p1 = l1, *p2 = l2;
        while(p1-&gt;next != nullptr || p2-&gt;next != nullptr){
            //填充较短的数, 高位添加0, 这一步可以用计算后再处理的办法替代
            if(p1-&gt;next == nullptr)
                p1-&gt;next = new ListNode(0);
            if(p2-&gt;next == nullptr)
                p2-&gt;next = new ListNode(0);
            p1 = p1-&gt;next, p2 = p2-&gt;next;
        }
        
        ListNode *head = new ListNode(0), *p = head;
        int jw = 0;//jw保存上一位计算后的进位
        for(p1 = l1, p2 = l2; p1 != nullptr &amp;&amp; p2 != nullptr; p1 = p1-&gt;next, p2 = p2-&gt;next){
            //模拟每一位的加法
            int t = p1-&gt;val + p2-&gt;val + jw;
            jw = (t &gt; 9 ? 1 : 0);
            
            t = t % 10;
            p-&gt;next = new ListNode(t);
            p = p-&gt;next;
        }
        if(jw == 1){
            //最后有进位的处理
            p-&gt;next = new ListNode(1);
        }
        
        return head-&gt;next;
    }
};</code></pre>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2016/07/08/leetcode-1-two-sum/">LeetCode 1. Two Sum</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Jul 8, 2016
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>LeetCode的第一题，题目如下：</p>
<blockquote>
<p>Given an array of integers, return indices of the two numbers such that they add up to a specific target.</p>
</blockquote>
<blockquote>
<p>You may assume that each input would have exactly one solution.</p>
</blockquote>
<blockquote>
<p><strong>Example:</strong></p>
</blockquote>
<blockquote>
<pre><code>Given nums = [2, 7, 11, 15], target = 9,
Because nums[0] + nums[1] = 2 + 7 = 9,
return [0, 1].
</code></pre>
</blockquote>
<p>首先是简单粗暴的使用STL Map的方法. 基本思路是把nums中的数据与其下标建立一个映射关系, 这样就可以在logn的时间里通过数值获得它的下标：</p>
<pre><code>class Solution {
public:
    vector&lt;int&gt; twoSum(vector&lt;int&gt;&amp; nums, int target) {
        map&lt;int, int&gt; a;
        for(int i = 0; i &lt; nums.size(); i++){
            a[nums[i]] = i;
        }
        for(int i = 0; i &lt; nums.size(); i++){
            auto p = a.find(target - nums[i]);
            if(p != a.end() &amp;&amp; p-&gt;second != i){
                vector&lt;int&gt; re = {i, p-&gt;second};
                return re;
            }
        }
        return vector&lt;int&gt;();
    }
};
</code></pre>
<p>以上方法有两个循环, 其中第一个循环遍历了一遍nums,同时对于每个nums中的数据都进行了map的插入/修改操作, 假设nums的数据个数为n, 复杂度约为O(nlogn). 第二个循环中也是遍历了一遍nums, 然后每一遍循环都执行了一次map的find()操作,最好的情况下只需要循环一次,最坏的情况下需要循环n次,因此平均复杂度约为O((n/2)logn), 总的复杂度在O(nlogn)级别.</p>
<p>这段程序运行时间28ms.</p>
<p>但是这个代码使用了STL中的Map容器, 可能有较大的额外开销, 接下来使用排序 + 二分搜索的方法:</p>
<pre><code>class Solution {
public:
    vector&lt;int&gt; twoSum(vector&lt;int&gt;&amp; nums, int target) {
        vector&lt;int&gt; re;
        vector&lt;int&gt; oldNums = nums;
        sort(nums.begin(), nums.end());
        for(int i = 0; i &lt; nums.size(); i++){
            int t = target - nums[i];
            if(t &lt; nums.front() || t &gt; nums.back()) continue;
            int j = binSearch(nums, t);
            if(j == -1 || j == i) continue;
            else {
                int num1 = nums[i], num2 = nums[j];
                for(int k = 0; k &lt; oldNums.size(); k++){
                    if(oldNums[k] == num1 || oldNums[k] == num2) re.push_back(k);
                    if(re.size() == 2) break;
                }
                return re;
            }
        }
        return re;
    }
    
    int binSearch(vector&lt;int&gt; &amp;nums, int t){
        int l = 0, r = nums.size(), m = (l + r) / 2;
        while(l &lt; r){
            if(nums[m] == t) return m;
            else if(nums[m] &gt; t) r = m;
            else l = m + 1;
            m = (l + r) / 2;
        }
        return -1;
    }
};
</code></pre>
<p>第二个方法的运行时间缩短为12ms.</p>
<p>还有另一种更加简洁的双指针方法:</p>
<pre><code>class Solution {
public:
    vector&lt;int&gt; twoSum(vector&lt;int&gt;&amp; nums, int target) {
        vector&lt;int&gt; re;
        vector&lt;int&gt; oldNums = nums;
        sort(nums.begin(), nums.end());
        int l = 0, r = nums.size() - 1;
        while(l &lt; r){
            int sum = nums[l] + nums[r];
            if(sum == target){
                for(int i = 0; i &lt; nums.size() &amp;&amp; re.size() &lt; 2; i++){
                    if(oldNums[i] == nums[l] || oldNums[i] == nums[r]) re.push_back(i);
                }
                break;
            }
            else if(sum &gt; target){
                r--;
            }
            else{
                l++;
            }
        }
        return re;
    }
};</code></pre>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2016/06/10/%E5%B7%9D%E5%A4%A7%E6%B1%9F%E5%AE%89%E6%A0%A1%E5%8C%BA%E5%AE%BD%E5%B8%A6%E7%A0%B4%E8%A7%A3/">川大江安校区宽带破解</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Jun 10, 2016
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <!-- toc -->
<h2 id="0-前言">0 前言</h2>
<p>四年大学生活马上就要结束了，想一想这四年在江安的生活还真是相当不错的；不过对于我来说，网络大概是江安学习生活中最烦人的东西了。从我2012年入学开始到现在的2016年，川大江安在宿舍所能使用的网络接入方式有三种：校园网、移动CMCC-EDU和电信宽带。其中校园网虽然免费，这四年来雷打不动的512kbps的带宽，基本是处于看图片都是煎熬的水平；CMCC-EDU我基本没用过，速度大概是4Mbps左右，可惜无线不稳定；剩下的电信宽带虽然非常贵（一个月79元，带宽6Mbps，但是可以抵扣话费，奈何我不用电信手机），但是矮子里面拔将军，是唯一比较好用的了。</p>
<p><strong>但是</strong>，这是建立在电信不限制路由器的基础上的。其实在2012年下半年的时候，电信宽带是不限制路由器的，使用普通的pppoe拨号方式就可以上网了。但是这只是电信认证系统的bug而已（还有另一种阴谋论的说法，就不详细说了。另外江安这个认证系统bug极多，后面我会详细说说），2013年上半年的时候修复了，导致路由器失效，接着电信更新了拨号器（就是本文将要破解的），导致飞扬俱乐部的在线算号器失效（方法是粗暴的禁止Linux版拨号器，至今再没有可用的官方Linux拨号器），当时在学生中算是引起了很大的反弹，可是学校方面不知道出于什么原因一直避而不谈这件事（<s>呵呵，这其中必然有肮脏的**交易</s>），电信抬出什么公安部教育部要求大学生上网一人一号的文件（<s>监控之心不死</s>）来当挡箭牌，这件事后来也不了了之了。但是不能用路由器你让手机iPad怎么上网？许多同学选择通过电脑发射无线信号（其实这也是被拨号器所屏蔽的，不过比较好突破），但是这个方法非常繁琐，要保持电脑一直开机。除了这种方法以外就只能放弃电信宽带了，不过我是一个网速多快都不嫌快，慢一点就无法忍受的人，所以就只能自己动手来破解电信的拨号器了。</p>
<p>在此要特别感谢软件学院的HZY同学，在我破解的过程中提供了很多帮助。</p>
<p><strong>我的宽带帐号是12年就有的，用户名是学号，跟后来的用户名是手机号的不一样，所以不保证对后来的账号有效。</strong></p>
<p>完整代码与原版Mac拨号器程序请移步<a href="https://github.com/xiadong1994/SCU_JiangAn_Dialer" target="_blank" rel="noopener">Github</a>。</p>
<h2 id="1-2-21版mac协同拨号器拨号流程">1 2.21版Mac协同拨号器拨号流程</h2>
<p>我在13年的时候破解的是2.21版的Mac拨号器，Windows版的拨号器的程序逻辑要相对复杂许多，这个版本的算法直到目前（16年6月）都还是可用的。PPPoE的介绍和普通的PPPoE拨号流程可以参考Wikipedia：<a href="https://www.wikiwand.com/zh-cn/PPPoE" target="_blank" rel="noopener">https://www.wikiwand.com/zh-cn/PPPoE</a>和RFC文档：<a href="https://tools.ietf.org/html/rfc2516" target="_blank" rel="noopener">https://tools.ietf.org/html/rfc2516</a>。计算机自带的PPPoE拨号器无法连接电信宽带的原因主要出在电信使用一种“二次验证”的机制，即计算机第一次拨号的时候是必然失败的，同时认证服务器返回一个字符串，拨号器根据这个字符串通过算法生成一个新的用户名，再次进行拨号才能成功。其中第一次拨号的用户名也是通过算法生成的，不过与服务器无关。</p>
<p>通过抓包就可以比较直观的看到拨号器拨号的整个流程，我已经很久没有装过协同拨号器了，在这里只贴一下我的路由器模拟的拨号过程。</p>
<p>这是第一次拨号的过程，可以看到CHAP认证失败并且返回16进制字符串：37f13ef44a72。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Jan  1 00:34:12 PandoraBox daemon.info pppd[2435]: Plugin rp-pppoe.so loaded.</span><br><span class="line">Jan  1 00:34:12 PandoraBox daemon.info pppd[2435]: RP-PPPoE plugin version 3.8p compiled against pppd 2.4.5</span><br><span class="line">Jan  1 00:34:12 PandoraBox daemon.notice pppd[2435]: pppd 2.4.5 started by root, uid 0</span><br><span class="line">Jan  1 00:34:12 PandoraBox daemon.info pppd[2435]: PPP session is 30874</span><br><span class="line">Jan  1 00:34:12 PandoraBox daemon.warn pppd[2435]: Connected to 00:25:9e:08:b8:3e via interface eth2.2</span><br><span class="line">Jan  1 00:34:12 PandoraBox daemon.info pppd[2435]: Using interface pppoe-wan</span><br><span class="line">Jan  1 00:34:12 PandoraBox daemon.notice pppd[2435]: Connect: pppoe-wan &lt;--&gt; eth2.2</span><br><span class="line">Jan  1 00:34:15 PandoraBox daemon.info pppd[2435]: syncppp not active</span><br><span class="line">Jan  1 00:34:15 PandoraBox daemon.info pppd[2435]: CHAP authentication failed: 37f13ef44a72</span><br><span class="line">Jan  1 00:34:15 PandoraBox daemon.err pppd[2435]: CHAP authentication failed</span><br><span class="line">Jan  1 00:34:15 PandoraBox daemon.notice pppd[2435]: Connection terminated.</span><br><span class="line">Jan  1 00:34:15 PandoraBox daemon.info pppd[2435]: Exit.</span><br></pre></td></tr></table></figure>
<p>这是第二次的拨号流程，可以看到认证成功并分配了IP地址等信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Jan  1 00:34:23 PandoraBox daemon.info pppd[2447]: Plugin rp-pppoe.so loaded.</span><br><span class="line">Jan  1 00:34:23 PandoraBox daemon.info pppd[2447]: RP-PPPoE plugin version 3.8p compiled against pppd 2.4.5</span><br><span class="line">Jan  1 00:34:23 PandoraBox daemon.notice pppd[2447]: pppd 2.4.5 started by root, uid 0</span><br><span class="line">Jan  1 00:34:23 PandoraBox daemon.info pppd[2447]: PPP session is 19277</span><br><span class="line">Jan  1 00:34:23 PandoraBox daemon.warn pppd[2447]: Connected to 00:25:9e:08:b8:3e via interface eth2.2</span><br><span class="line">Jan  1 00:34:23 PandoraBox daemon.info pppd[2447]: Using interface pppoe-wan</span><br><span class="line">Jan  1 00:34:23 PandoraBox daemon.notice pppd[2447]: Connect: pppoe-wan &lt;--&gt; eth2.2</span><br><span class="line">Jan  1 00:34:26 PandoraBox daemon.info pppd[2447]: syncppp not active</span><br><span class="line">Jan  1 00:34:26 PandoraBox daemon.info pppd[2447]: CHAP authentication succeeded: Authentication success,Welcome!</span><br><span class="line">Jan  1 00:34:26 PandoraBox daemon.notice pppd[2447]: CHAP authentication succeeded</span><br><span class="line">Jan  1 00:34:26 PandoraBox daemon.notice pppd[2447]: peer from calling number 00:25:9E:08:B8:3E authorized</span><br><span class="line">Jan  1 00:34:26 PandoraBox daemon.notice pppd[2447]: local  IP address 220.167.43.208</span><br><span class="line">Jan  1 00:34:26 PandoraBox daemon.notice pppd[2447]: remote IP address 220.167.40.1</span><br><span class="line">Jan  1 00:34:26 PandoraBox daemon.notice pppd[2447]: primary   DNS address 61.139.2.69</span><br><span class="line">Jan  1 00:34:26 PandoraBox daemon.notice pppd[2447]: secondary DNS address 202.98.96.68</span><br><span class="line">Jan  1 00:34:26 PandoraBox daemon.notice netifd: Interface &#39;wan&#39; is now up</span><br></pre></td></tr></table></figure>
<h2 id="3-关于如何破解">3 关于如何破解</h2>
<p>主要使用IDA作为反汇编工具，最关键的就是阅读反汇编拨号器出来的汇编代码和IDA生成的反编译代码。编写自己的拨号器的使用的是C语言，当然也可以自由选择其他的语言。使用libpcap在程序内进行抓包。我在破解的最后阶段还用了GDB在命令行模式下直接调试官方拨号器，在没有调试信息的情况下跟踪程序运行真是很酸爽。</p>
<p>这个破解程序是差不多三年前写的了，当时接触编程和C语言不到一年，代码写的很烂，但是因为一直能用就没有再做什么改动了。</p>
<h2 id="4-生成第一次拨号的用户名">4 生成第一次拨号的用户名</h2>
<p>这个生成第一次拨号用户名的算法是完全模拟的协同拨号器的工作方式。首先获取系统时间，再和一个特殊字符串、用户名、密码拼接成一个新字符串：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">time1=time(<span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">sprintf</span>((<span class="keyword">char</span>*)strTime,<span class="string">"%08x"</span>,time1);</span><br><span class="line">    <span class="built_in">sprintf</span>((<span class="keyword">char</span>*)first,<span class="string">"%s%s%s%s"</span>,strTime,<span class="string">"m2o=crE54nyNUht["</span>,username,psw);</span><br></pre></td></tr></table></figure>
<p>对该字符串计算MD5值并转换成16进制表示的字符串：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MD5_CTX md5;</span><br><span class="line">MD5Init(&amp;md5);         		</span><br><span class="line">MD5Update(&amp;md5,first,<span class="built_in">strlen</span>((<span class="keyword">char</span>*)first));</span><br><span class="line">MD5Final(&amp;md5,md5Result);</span><br><span class="line"><span class="comment">//把md5转换成字符串</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">16</span>;j++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">sprintf</span>((<span class="keyword">char</span>*)pMd5Str,<span class="string">"%02x"</span>,md5Result[j]);</span><br><span class="line">    pMd5Str+=<span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后取该字符串的前19个字符，再与其他字符串一起拼接成最终的用户名：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> md5Str19[<span class="number">20</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="built_in">memcpy</span>(md5Str19,md5Str,<span class="number">19</span>);	<span class="built_in">sprintf</span>((<span class="keyword">char</span>*)userName,<span class="string">"%s%s%s%s%s"</span>,strTime,<span class="string">"M"</span>,<span class="string">"2021"</span>,md5Str19,username);</span><br></pre></td></tr></table></figure>
<h2 id="5-进行拨号">5 进行拨号</h2>
<p>获得了第一个用户名之后就可以进行拨号了。这个拨号的方法是根据不同的平台而不同，我在Windows和Linux系统（主要是路由器运行的OpenWRT）上都移植过这个程序，可以说唯一需要修改的地方就是这里了。我在这里放一下我在路由器上运行的版本的拨号函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PPPoeDial</span><span class="params">(<span class="keyword">char</span> *user,<span class="keyword">char</span> *pwd,<span class="keyword">char</span> *name,<span class="keyword">char</span> *device)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> pppoe_cmd[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">char</span> ifname[<span class="number">40</span>]=<span class="string">"pppoe-"</span>;</span><br><span class="line">    <span class="built_in">sprintf</span>(pppoe_cmd,<span class="string">"/usr/sbin/pppd nodetach ipparam %s ifname %s nodefaultroute usepeerdns persist maxfail 1 user %s password %s ip-up-script /lib/netifd/ppp-up ipv6-up-script /lib/netifd/ppp-up ip-down-script /lib/netifd/ppp-down ipv6-down-script /lib/netifd/ppp-down mtu 1492 mru 1492 plugin rp-pppoe.so nic-%s &amp;"</span>,\</span><br><span class="line">    name,<span class="built_in">strcat</span>(ifname,name),user,pwd,device);</span><br><span class="line">    system(pppoe_cmd);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"拨号中。。。"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的pppoe_cmd的内容要根据对应的平台调整。<strong>Windows平台本身就提供了拨号函数，不需要运行pppd之类的命令了。</strong></p>
<h2 id="6-获取服务返回的参数">6 获取服务返回的参数</h2>
<p>在我的程序中是通过使用libpcap库进行抓包来获取服务器返回的字符串的。libpcap库相关的信息请访问官网<a href="http://www.tcpdump.org" target="_blank" rel="noopener">http://www.tcpdump.org</a>。对每个数据包的回调函数是这样的：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">packet_handler</span><span class="params">(u_char *param, <span class="keyword">const</span> struct pcap_pkthdr *header, <span class="keyword">const</span> u_char *pkt_data)</span></span></span><br><span class="line"><span class="function"></span>&#123;    </span><br><span class="line">    <span class="keyword">if</span>(valid &amp;&amp; pkt_data[<span class="number">22</span>]==<span class="number">0x04</span>&amp;&amp;pkt_data[<span class="number">23</span>]==<span class="number">0x01</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pcap_breakloop(adhandle);</span><br><span class="line">        valid = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span> seed[<span class="number">10</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">        		<span class="built_in">sprintf</span>(&amp;seed[i],<span class="string">"%c"</span>,pkt_data[<span class="number">30</span>+i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"seed:%s\n"</span>,seed);</span><br><span class="line">        <span class="keyword">int</span> time2=((<span class="keyword">unsigned</span> <span class="keyword">int</span>)rand())&lt;&lt;<span class="number">16</span>|rand();</span><br><span class="line">        <span class="keyword">char</span> result[<span class="number">50</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">        getSecondUserName(result,seed,g_userName,g_pwd,time1,time2);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,result);</span><br><span class="line">        sleep(<span class="number">8</span>);</span><br><span class="line">        PPPoeDial(result,g_pwd,wan,d-&gt;name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中<code>pkt_data[22]==0x04&amp;&amp;pkt_data[23]==0x01</code>是表示这个数据包是服务器返回的认证失败的数据包，从中取得字符串<code>seed</code>，然后产生一个随机数time2，作为产生第二个用户名的参数。sleep(8)的目的是等待第一次拨号的进程完全退出以免造成冲突。
​</p>
<h2 id="7-生成第二次的用户名">7 生成第二次的用户名</h2>
<p>生成第二次用户名的函数比较复杂，具体还是参见代码中的实现吧。主要思路仍然是对字符串进行处理后计算MD5值再进行拼接。</p>
<h2 id="8-运行平台">8 运行平台</h2>
<p>在破解出这个算法后，我写过Windows和OpenWRT版本的拨号器，我相信大多数同学都是想使用路由器的，使用路由器很简单，只需要一个刷了OpenWRT的路由器就可以了，下载相应的工具链之后进行交叉编译，把得到的可执行文件上传到路由器上，再添加启动脚本就可以实现开机自动连接宽带了。</p>
<h2 id="9-后记与扯扯淡">9 后记与扯扯淡</h2>
<p>江安校区的电信宽带真的是相当奇葩，贵而难用，而且BUG多多，单单我知道的就有：把用户名最后几位去掉就可以使用无上限的带宽（取决于你寝室的出口物理带宽）；同样是去掉几位就可以进行无限制的多拨（带宽叠加）；绑定的手机号注销之后宽带帐号还在等等。靠着前两个bug我还是享受了将近两年的50M以上宽带的，虽然到现在这些bug已经修复了，但是说不定还是有其他bug，这就交给学弟学妹们来开发啦。</p>
<p>有了OpenWRT路由器之后可玩的东西就变得挺多了，完全可以当一个24h运行小服务器来用。比如以前我还在用多拨叠加宽带的时候因为有一定概率拨号失败（挺低的），所以就写了一个shell脚本，拨号完成后发邮件通知我有没有没连上的连接。或者写一个桥接CMCC信号并且自动登陆的脚本等等。</p>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2016/04/21/%E5%9C%A8qt%E4%B8%AD%E4%BD%BF%E7%94%A8botan%E5%BA%93%E8%BF%9B%E8%A1%8C%E5%8A%A0%E8%A7%A3%E5%AF%86/">在Qt中使用Botan库进行加解密</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Apr 21, 2016
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <h1 id="在qt中使用botan库进行加解密">在Qt中使用Botan库进行加解密</h1>
<p>在毕设项目中需要使用RSA和AES加解密, 因为Qt自带Botan库, 所以使用Botan库来实现. Botan项目网站<a href="http://botan.randombit.net" target="_blank" rel="noopener">http://botan.randombit.net</a></p>
<h2 id="在项目中使用">在项目中使用</h2>
<p>因为Qt Creator自带Botan库, 所以很容易就可在Qt项目中使用. 首先到Qt Creator的Github页面<a href="https://github.com/qtproject/qt-creator" target="_blank" rel="noopener">https://github.com/qtproject/qt-creator</a>, 找到<code>qt-creator/src/libs/3rdparty/botan/</code>目录, 下载其中的文件. 然后在项目的pro文件中使用<code>include(botan/botan.pri)</code>引入Botan的源代码.</p>
<h2 id="rsa加解密">RSA加解密</h2>
<p>引入头文件
#include “botan/botan.h”</p>
<p>生成密钥对</p>
<pre><code>Botan::AutoSeeded_RNG rng;
Botan::RSA_PrivateKey privateKey(rng, 1024);
</code></pre>
<p>输出密钥</p>
<pre><code>qDebug() &lt;&lt; Botan::X509::PEM_encode(privateKey).c_str() &lt;&lt; Botan::PKCS8::PEM_encode(privateKey).c_str();
</code></pre>
<p>对字符串加密</p>
<pre><code>Botan::PK_Encryptor_EME enc(privateKey, &quot;EME1(SHA-256)&quot;);
char msg[] = &quot;Test&quot;;
Botan::SecureVector&lt;Botan::byte&gt; en = enc.encrypt(msg, 6, rng);
</code></pre>
<p>解密</p>
<pre><code>Botan::PK_Decryptor_EME dec(privateKey, &quot;EME1(SHA-256)&quot;);
Botan::SecureVector&lt;Botan::byte&gt; re = dec.decrypt(en);
</code></pre>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2016/03/16/windows%E5%B9%B3%E5%8F%B0poppler-qt5%E9%A2%84%E7%BC%96%E8%AF%91%E5%BA%93/">Windows平台poppler-qt5预编译库</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Mar 16, 2016
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>项目中要对PDF文件进行预览, 搜索与Qt搭配的库之后选择poppler库, 官网地址: <a href="https://poppler.freedesktop.org/" target="_blank" rel="noopener">https://poppler.freedesktop.org/</a>, 没有找到win32平台的二进制文件, 所以只能下载源码自行编译, 由于依赖库众多, 经常报莫名其妙的编译错误, 在耗费了十几个小时后终于编译出了可用的dll文件, 在Qt工程中使用正常. 为了备份和方便后来人, 提供编译好的poppler-qt5的库下载.</p>
<p><strong>poppler版本:</strong></p>
<p>0.41.0</p>
<p><strong>编译器</strong></p>
<ul>
<li>gcc 5.1.0 32-bit</li>
<li>mingw32-make GNU make 3.82.90</li>
</ul>
<p><strong>目录结构</strong></p>
<pre><code>libpoppler.zip
|
|--bin
|   |--freetype6.dll
|   |--jpeg62.dll
|   |--libpoppler.dll
|   |--libpoppler-qt5.dll
|   |--libtiff3.dll
|   |--openjpeg.dll
|   |--pdfinfo.exe
|   |--zlib1.dll
|
|--include
|   |--poppler
|       |--qt5
|           |--poppler-annotation.h
|           |--poppler-export.h
|           |--poppler-form.h
|           |--poppler-link.h
|           |--poppler-media.h
|           |--poppler-optcontent.h
|           |--poppler-page-transition.h
|           |--poppler-qt5.h
|
|--lib
    |--libpoppler.dll.a
    |--libpoppler-qt5.dll.a
</code></pre>
<p><strong>下载地址:</strong></p>
<p><a href="https://pub-b8c7c13887be4f9fb8bd159a86e85ef5.r2.dev/libpoppler.zip" target="_blank" rel="noopener">https://pub-b8c7c13887be4f9fb8bd159a86e85ef5.r2.dev/libpoppler.zip</a></p>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2016/01/02/c++qt%E6%93%8D%E4%BD%9Cword%E6%A8%A1%E7%89%88%E5%9F%BA%E7%A1%80/">C++&Qt操作Word模版基础</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Jan 2, 2016
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>项目中要对Word模版进行操作, 使用C++&amp;Qt进行开发, 将学到的东西记录如下.</p>
<h2 id="0-参考链接">0 参考链接</h2>
<ol>
<li>
<p><a href="https://en.wikipedia.org/wiki/OLE_Automation" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/OLE_Automation</a></p>
</li>
<li>
<p><a href="http://www.cgoakley.org/prog/oleaut.html" target="_blank" rel="noopener">http://www.cgoakley.org/prog/oleaut.html</a></p>
</li>
<li>
<p><a href="https://zh.wikipedia.org/wiki/ActiveX" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/ActiveX</a></p>
</li>
<li>
<p><a href="http://www.oschina.net/question/1243014_120926" target="_blank" rel="noopener">http://www.oschina.net/question/1243014_120926</a></p>
</li>
<li>
<p><a href="http://blog.csdn.net/csxiaoshui/article/details/47333989" target="_blank" rel="noopener">http://blog.csdn.net/csxiaoshui/article/details/47333989</a></p>
</li>
</ol>
<h2 id="1-基础知识">1 基础知识</h2>
<h3 id="1-1-ole-automation">1.1 OLE Automation</h3>
<p>在Windows应用开发中, OLE Automation是一种进程间通信机制. 它基于COM和MFC, 因此在我的项目中并不适用.<a href="https://en.wikipedia.org/wiki/OLE_Automation" target="_blank" rel="noopener">[1]</a><a href="http://www.cgoakley.org/prog/oleaut.html" target="_blank" rel="noopener">[2]</a></p>
<blockquote>
<p>OLE（Object Linking and Embedding，对象链接与嵌入），是能让应用程序创建包含不同来源的复合文档的一项技术。OLE不仅是桌面应用程序集成，而且还定义和实现了一种允许应用程序作为软件“对象”（数据集合和操作数据的函数）彼此进行“链接”的机制，这种链接机制和协议称为部件对象模型(Component Object Model),简称COM。OLE可以用来创建复合文档，复合文档包含了创建于不同源应用程序，有着不同类型的数据，因此它可以把文字、声音、图像、表格、应用程序等组合在一起。</p>
</blockquote>
<h3 id="1-2-activex">1.2 ActiveX</h3>
<p>根据Wikipedia<a href="https://zh.wikipedia.org/wiki/ActiveX" target="_blank" rel="noopener">[3]</a>, ActiveX的含义是:</p>
<blockquote>
<p>ActiveX在广义上是指微软公司的整个COM架构，但是现在通常用来称呼基于标准COM接口来实现对象链接与嵌入（OLE）的ActiveX控件。[1]后者是指从VBX发展而来的，面向微软的Internet Explorer技术而设计的以OCX为扩展名的OLE控件。通过定义容器和组件之间的接口规范，如果编写了一个遵循规范的控件，那么可以很方便地在多种容器中使用而不用修改控件的代码。同样，通过实现标准接口调用，一个遵循规范的容器可以很容易地嵌入任何遵循规范的控件。由于OLE在ActiveX控件中的应用的普及，现在OLE技术中只有少数独立于ActiveX技术，例如复合文档。</p>
</blockquote>
<h2 id="2-qt中的activex-5">2 Qt中的ActiveX<a href="http://blog.csdn.net/csxiaoshui/article/details/47333989" target="_blank" rel="noopener">[5]</a></h2>
<p>Qt中提供QtActiveX模块来支持ActiveX, 有两种开发方式:</p>
<ol>
<li>将已有的COM或者ActiveX空间引入到Qt的应用程序中</li>
<li>将Qt应用程序或者Qt的对象导出成COM对象或者ActiveX控件供他人使用</li>
</ol>
<p>Qt是通过两个模块来支持上述所说的两种方式的:</p>
<ol>
<li>使用QAxContainer模块, 通过QAxObject和QAxWidget分别支持COM对象和ActiveX控件的开发, 可以通过这两个对象将外部的COM或者ActiveX组件接入到Qt应用程序.</li>
<li>使用QAxServer模块, 通过QAxAggregated, QAxBindable和QAxFactory类, 通过了进程内和可执行程序exe两种方式的COM Server模式, 用来将Qt写的内容导出为COM或者ActiveX供他人使用.</li>
</ol>
<h2 id="3-qt中使用activex-4">3 Qt中使用ActiveX<a href="http://www.oschina.net/question/1243014_120926" target="_blank" rel="noopener">[4]</a></h2>
<p>Qt版本5.4.2, 编译器: MinGW 4.9.1 32-bit.</p>
<h3 id="3-1-准备工作">3.1 准备工作</h3>
<p>创建一个Word模版, 插入一个表格和三个书签: pos1, pos2, pos3. 保存为Doc1.dot.</p>
<p><img src="https://lh3.googleusercontent.com/-Vh0Ca5Homwc/VofF7M2vCwI/AAAAAAAAD0M/BazOwEELCWwZjizGLApPj9JHnXGzQARrACCo/s800/20160102200655.png" alt=""></p>
<h3 id="3-2-在项目的-pro文件中增加如下一行">3.2 在项目的.pro文件中增加如下一行</h3>
<pre><code>QT   += axcontainer`&lt;/pre&gt;
</code></pre>
<h3 id="3-3-新建qt项目-输入如下代码">3.3 新建Qt项目,输入如下代码:</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QAxWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QAxObject&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">  MainWindow w;</span><br><span class="line">  w.show();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//新建一个word应用程序</span></span><br><span class="line">  QAxWidget *<span class="keyword">word</span> = <span class="keyword">new</span> QAxWidget(<span class="string">"Word.Application"</span>, <span class="number">0</span>, Qt::MSWindowsOwnDC);</span><br><span class="line">  <span class="comment">//设置为不可见</span></span><br><span class="line">  <span class="keyword">word</span>-&gt;setProperty(<span class="string">"Visible"</span>, <span class="literal">false</span>);</span><br><span class="line">  <span class="comment">//获取所有工作文档</span></span><br><span class="line">  QAxObject *docs = <span class="keyword">word</span>-&gt;querySubObject(<span class="string">"Documents"</span>);</span><br><span class="line">  <span class="comment">//新建一个文档</span></span><br><span class="line">  docs-&gt;dynamicCall(<span class="string">"Add(QString)"</span>, QString::fromLocal8Bit(<span class="string">"E:\\Study\\Design\\WordTempTest\\Doc1.dot"</span>));</span><br><span class="line">  <span class="comment">//获取激活文档</span></span><br><span class="line">  QAxObject *activeDoc = <span class="keyword">word</span>-&gt;querySubObject(<span class="string">"ActiveDocument"</span>);</span><br><span class="line">  <span class="comment">//获取pos1标签</span></span><br><span class="line">  QAxObject *bookmarkPos1 = activeDoc-&gt;querySubObject(<span class="string">"Bookmarks(QVariant)"</span>, <span class="string">"pos1"</span>);</span><br><span class="line">  <span class="comment">//选中并插入字符</span></span><br><span class="line">  <span class="keyword">if</span>(!bookmarkPos1-&gt;isNull())&#123;</span><br><span class="line">    bookmarkPos1-&gt;dynamicCall(<span class="string">"Select(void)"</span>);</span><br><span class="line">    bookmarkPos1-&gt;querySubObject(<span class="string">"Range"</span>)-&gt;setProperty(<span class="string">"Text"</span>, <span class="string">"pos1"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//获取pos2标签</span></span><br><span class="line">  QAxObject *bookmarkPos2 = activeDoc-&gt;querySubObject(<span class="string">"Bookmarks(QVariant)"</span>, <span class="string">"pos2"</span>);</span><br><span class="line">  <span class="comment">//选中并插入字符</span></span><br><span class="line">  <span class="keyword">if</span>(!bookmarkPos2-&gt;isNull())&#123;</span><br><span class="line">    bookmarkPos2-&gt;dynamicCall(<span class="string">"Select(void)"</span>);</span><br><span class="line">    bookmarkPos2-&gt;querySubObject(<span class="string">"Range"</span>)-&gt;setProperty(<span class="string">"Text"</span>, <span class="string">"pos2"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//获取pos3标签</span></span><br><span class="line">  QAxObject *bookmarkPos3 = activeDoc-&gt;querySubObject(<span class="string">"Bookmarks(QVariant)"</span>, <span class="string">"pos3"</span>);</span><br><span class="line">  <span class="comment">//选中并插入字符</span></span><br><span class="line">  <span class="keyword">if</span>(!bookmarkPos3-&gt;isNull())&#123;</span><br><span class="line">    bookmarkPos3-&gt;dynamicCall(<span class="string">"Select(void)"</span>);</span><br><span class="line">    bookmarkPos3-&gt;querySubObject(<span class="string">"Range"</span>)-&gt;setProperty(<span class="string">"Text"</span>, <span class="string">"pos3"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//文档另存为Doc1.doc</span></span><br><span class="line">  activeDoc-&gt;dynamicCall(<span class="string">"SaveAs (const QString&amp;)"</span>, QString(<span class="string">"E:\\Study\\Design\\WordTempTest\\Doc1.doc"</span>));</span><br><span class="line">  activeDoc-&gt;dynamicCall(<span class="string">"Close (boolean)"</span>, <span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">word</span>-&gt;dynamicCall(<span class="string">"Quit()"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> a.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-4-运行结果">3.4 运行结果</h2>
<p>程序运行后Doc1.doc文件的内容:</p>
<p><img src="https://lh3.googleusercontent.com/-dAT5kINBxfQ/VofF7O-Oo7I/AAAAAAAAA18/iiKZDWcC8wo/s800-Ic42/20160102204208.png" alt=""></p>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2015/12/30/windows-10-%E8%87%AA%E5%8A%A8%E9%94%81%E5%B1%8F%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/">Windows 10 自动锁屏问题解决</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Dec 30, 2015
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <h2 id="问题">问题</h2>
<p>升级到Windows10以后我遇到的各种小毛病不少，比如中文输入法失灵，锁屏无法显示幻灯片还有这次要说的自动锁屏问题。前两个问题基本上都已经解决了，但是这个自动锁屏的问题却还是顽固地出现。</p>
<p>具体的症状表现就是每半小时就会自动锁屏，无论在干什么都是这样。不过幸好这个问题不是一直不停地出现，一般都是在睡眠唤醒之后半小时出现一次，虽然很烦但是对于我这样的懒人还不是无法忍受。可是今天这种情况反复不停出现，每半小时一次，所以我不得不想办法把它彻底解决了。</p>
<h2 id="问题原因"><s>问题原因</s></h2>
<p><strong>晚上这个问题又出现了，所以这并不是直接原因</strong></p>
<p><s>由于是精确的每半小时出现一次，所以我就到事件查看器里看看到底是出了什么状况。很容易就找到了相应的事件：</s>
<img src="http://7xkh37.com1.z0.glb.clouddn.com/20151230141322.png" alt="">
<s>所对应的具体信息为：</s></p>
<blockquote>
<p><s>应用程序-特定 权限设置并未向在应用程序容器 不可用 SID (不可用)中运行的地址 LocalHost (使用 LRPC) 中的用户 NT AUTHORITY\SYSTEM SID (S-1-5-18)授予针对 CLSID 为 {D63B10C5-BB46-4990-A94F-E40B9D520160}、APPID 为 {9CA88EE3-ACB7-47C8-AFC4-AB702511C276}</s></p>
</blockquote>
<h2 id="解决方案"><s>解决方案</s></h2>
<p><strong>同样这也不是解决方法</strong></p>
<p><s>Google之后，根据<a href="http://www.lxway.com/458800126.htm" target="_blank" rel="noopener">这篇文章</a>所描述的方法设置了权限之后重启，问题解决。</s></p>
<h2 id="可能的其他原因">可能的其他原因</h2>
<p>根据MS Community的这篇帖子(<a href="http://answers.microsoft.com/en-us/windows/forum/windows_10-security/windows-10-auto-locks-every-30-minutes-even-when/b53e7ff7-7644-4d51-8038-62f8f2eb9a26" target="_blank" rel="noopener">http://answers.microsoft.com/en-us/windows/forum/windows_10-security/windows-10-auto-locks-every-30-minutes-even-when/b53e7ff7-7644-4d51-8038-62f8f2eb9a26</a>)，可能的原因是由于锁屏幻灯片导致的，而我的锁屏幻灯片也确实是有问题的，按照帖子的说法把锁屏幻灯片关掉就好，可是我并不想关，所以我先把<strong>设置-&gt;个性化-&gt;锁屏界面-&gt;高级幻灯片放映设置-&gt;自动关闭屏幕</strong>设置为不自动关闭（因为这里原来设置为30分钟，跟锁屏的频率吻合）。接下来就要看看还会不会出现同样的问题了。</p>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2015/04/17/2015%E8%85%BE%E8%AE%AF%E5%AE%9E%E4%B9%A0%E7%AC%94%E8%AF%95%E9%9D%A2%E8%AF%95offer/">2015腾讯实习笔试+面试+offer</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Apr 17, 2015
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>本来我是已经决定要保研，但是这个学期还是投了一些实习简历，主要是想看一下我的水平到底如何，顺便也能感受一下找工作的感觉。寒假快要结束的时候给阿里投了内推，在寒假的最后一天接到电面，面试过程相当坑爹，我基本是裸面，结果是毫无悬念的跪了。来到学校之后又尝试着投了腾讯和阿里的正式校招，也参加了微软的在线笔试（到现在都没有动静估计也是没戏了）。上个星期腾讯面试完，今天拿到offer，简单记录一下腾讯实习的面试经历。</p>
<h2 id="笔试">笔试</h2>
<p>笔试在电子科大在郫县的校区进行，人数还是不少了，占用了不少阶梯教室。基本上所有报技术职位的都使用一张笔试试卷，很长的一张，正反一共十面，不过有大概三分之一是各个事业群的介绍。有20（还是25道？）选择题（都是不定项选择题），和四道简答题。总体来说难度不是很小，考察了js，C/C++，计算机网络，数据库，运维和一些概率统计方面的问题。我感觉至少有一半的题目不确定，印象比较深刻的知识点有字节对齐，基类有虚函数的派生类的大小等等。。。记忆已经有些模糊了。大题第一题是存储了很多很多QQ号的vector、set和map其中的两个（= =我已经记不清了），删除其中是奇数的QQ号，写算法。第二题是经典的斐波那契数列问题。第三题和第四题已经忘记了，只记得做了第三题，第四题和第一题一样是空白。</p>
<h2 id="一面">一面</h2>
<p>笔试似乎刷人不多，跟我一起笔试的同学基本都进入面试了。面试是在成都的明宇尚雅饭店进行，就在锦江边上，4月7号晚上发短信要第二天早上11点面试。</p>
<p>第二天早上先坐67路再转地铁到华西坝站，出地铁站走几百米就到了。到那里发现人还是很多的，大概是一面的人比较多的缘故，还遇到了CJW君去霸面（而且还霸面成功了。。。）。签到之后等了没几分钟就让去楼上面试。面试官是一个瘦瘦的眼镜小哥。主要问的问题有</p>
<ul>
<li>结构体字节对齐(<a href="http://www.cnblogs.com/clover-toeic/p/3853132.html" target="_blank" rel="noopener">C语言字节对齐问题详解</a>)</li>
<li>要求不对齐有哪些方法</li>
<li>异构网络中怎么解决不同主机对齐不同的问题（没答出来）</li>
<li>C可变参数(<a href="http://blog.csdn.net/jackystudio/article/details/17523523" target="_blank" rel="noopener">【C++基础之二十】可变参数的函数</a>)</li>
<li>笛卡尔积（数据库）</li>
<li>左右连接</li>
<li>tcp建立拆除(三次和四次握手，这问题几乎是必问，阿里问了，后面的二面也问了)</li>
<li>md5冲突（md5重复的问题）</li>
<li>实习地点、时间</li>
<li>C++只问了会不会没有具体问</li>
</ul>
<p>一共大概二十多分钟就出来了，没有要求写代码。</p>
<h2 id="还是一面">还是一面。。。</h2>
<p>我自认为第一次面试回答的还是不错的，只有一个没答出来。可是回学校的时候一查。。。岗位不合适。。。= =#，结合后面的面试经历我猜测面试官一开始就没打算让我进微信事业群（我报的微信事业群后台开发），基本没有问什么有实际意义的东西。</p>
<p>到了晚上十一点多的时候又接到短信，再去初试（一面），看来是换了个部门。第二天下午6点半又到了饭店，这次等待面试的地方人明显少了很多（这个时候一面已经基本结束了）。这次直接到顶楼，面试官年纪比上一个要大一些。上来没有自我介绍，先问我会啥，我说C/C<ins>比较熟，于是就问：“说一说C</ins>的多态吧”。C++这方面的东西还是前几天恶补的，只能硬着头皮扯。扯到了动态绑定、虚函数等等，然后面试官问虚函数的继承是怎么实现的，有什么意义。我只说出来了虚函数表。。。又问为什么基类的析构函数一般都是虚函数，这个我是看过的，可是一下子想不起来。。。这个话题结束了。。。下一个问题是new和malloc的区别，这个我还有点印象；然后问到堆与栈的区别；静态变量存储在哪个区域。这些都答上来了。然后问到从数据库中读取了很多联系人数据，在内存中用什么数据结构来管理，要求搜索，排序，添加删除都比较快，数组添加删除太慢，链表搜索排序慢，最后我也只扯出来了平衡二叉搜索树这种，本来想说B+树可是实在不熟。接下来是三个数据结构题：</p>
<ul>
<li>两个单向链表可能相交也可能不相交，求相交的节点（暴力遍历不行）</li>
<li>一个字符串中单词顺序反转（反转两次）</li>
<li>交换单链表的相邻两个节点（这个要手写代码，前面两个讲思路）</li>
</ul>
<p>这三个题答得都还不错。面试官说可以进入复试，然后我问了一下现在面的是什么部门，结果是SNG（社交网络事业群）的移动客户端。。。就是手机QQ、QQ空间等。然后面试结束，让我明天早上来复试。</p>
<h2 id="二面">二面</h2>
<p>坐电梯刚到一楼接到面试官的电话，说我现在就可以去二面，于是又坐电梯上去。这次的面试官气场有点强。。。先问了问项目经历、成绩等等。然后开始写代码，先是经典的上台阶问题，然后要求实现strlen，我只考虑了空指针的问题，然后用遍历来求长度，然后面试官问怎么优化。。我是没想出来（回来之后才知道要优化一要分配寄存器，二要考虑字节对齐）；然后是一个很长的字符串，求第一个只出现了一次的字符。接下来问了一个智力题：两个外观大小重量都完全相同的金球和铅球在不破坏它们的情况下怎么区分开。。。我一开始想的是硬度，可是这被认为破坏了，然后是导电性，被说不好操作，其他的我也没想出来。最后问了数据库的问题，谈到了项目中用的框架，于是又聊到了框架对SQL的封装等等。。。最后得到的评价是还不错，但是项目经验太少。</p>
<h2 id="hr面">HR面</h2>
<p>二面之后我基本确定能进HR面了。HR面没有技术问题，问了籍贯、家庭背景、爱好、对成都怎么看、能不能去深圳实习等等问题。HR小哥明显跟前面的技术面试官不一样，也热情的多。</p>
<h2 id="offer">offer</h2>
<p>一个星期后接到电话说拿到了实习名额，但是啊。。但是，考虑再三还是决定保研为重，学院还要求必须七月去实训，时间也不够还是决定拒掉实习offer了。下个月的阿里面试估计也不会再去了。。。</p>
<h2 id="总结">总结</h2>
<p>校招时对于本科生的技术要求不是太高，面对面的面试中也不太可能出现复杂的问题，时间上也来不及，所以问的问题多集中在语言的特性（对语言的熟练程度）和数据结构上。还有简历不要乱写，写在上面的每一条都有可能被刨根问底，不是很熟悉的项目还是不要写为妙。我都没有敢说对Python比较熟，因为我只是用它但是却没有极其深入的研究，随随便便就能被问倒。</p>
<p>重点还是在计算机专业的核心科目上：C/C++，计算机网络，数据结构与算法、操作系统和数据库等。</p>
<p>说实话能拿到实习offer还是很幸运的，我的水平还是不够啊。。。</p>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2015/03/13/%E4%BD%BF%E7%94%A8%E5%BE%AE%E8%BD%AF%E7%9A%84%E5%85%8D%E8%B4%B9git%E6%9C%8D%E5%8A%A1/">使用微软的免费Git服务</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Mar 13, 2015
        </span>
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>Github上的软件仓库必须公开，今天找了一下免费的私人Git，找到了bitbucket和Visual Studio Online。权衡了一下还是选择了微软的。<a href="www.visualstudio.com" title="www.visualstudio.com">www.visualstudio.com</a></p>

        
      
    </div>

    

    

  </article>

    
  </section>

  
  <nav class="pagination">
    
      <a class="prev" href="/page/40/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">Prev</span>
      </a>
    
    
      <a class="next" href="/page/42/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>


          </div>
          

        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:xiadong.main@gmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
        
          <a href="https://www.facebook.com/xiadong1994" target="_blank" rel="noopener" class="iconfont icon-facebook" title="facebook"></a>
        
      
    
      
        
          <a href="https://www.linkedin.com/in/dong-xia" target="_blank" rel="noopener" class="iconfont icon-linkedin" title="linkedin"></a>
        
      
    
      
    
      
        
          <a href="https://github.com/Shell32-Natsu" target="_blank" rel="noopener" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
    
    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>



<div class="friend-links">
    <span>Links:&nbsp;</span>
    
        <a href="https://wf94.github.io/" target="_blank" rel="noopener" class="friend-links-item">打满鸡血来刷题</a>
    
        <a href="http://tianyuh.com/" target="_blank" rel="noopener" class="friend-links-item">塞外麾下炙</a>
    
</div>


<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>
  </span>
  
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even" target="_blank" rel="noopener">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2014 - 
    
    2025

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Shell32</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    


    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.3.x"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.3.x"></script>
<script type="text/javascript">
$(function(){
    const imgs = $("img").filter(function() {
        return this.src.match(/.*\.sinaimg\.cn\/.*/);
    });
    for (let i = 0; i < imgs.length; i++) {
        let img = imgs[i];
        $(img).attr('referrerpolicy', 'no-referrer');
    }
    console.log(`Removed referrer header for ${imgs.length} sina weibo images.`);
});
</script>
    
    <!-- Go to www.addthis.com/dashboard to customize your tools --> <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-58f2179bf0859c32"></script> 
  </body>
</html>
